SELECT go_gem_bfs, ts.geometrie
FROM
(
 SELECT gem_bfs, geometrie
 FROM av_avdpool_ng.tseinteilung_toleranzstufe
 WHERE art = 1
) as ts,
(
 SELECT go_gem_bfs, gem_bfs, wkb_geometry
 FROM av_lokale_entzerrung.gemeinde_operate
 WHERE go_gem_bfs = 2450
) gem
WHERE gem.gem_bfs = ts.gem_bfs
AND gem.wkb_geometry && ts.geometrie
AND ST_Intersects(gem.wkb_geometry, ts.geometrie);


SELECT FALSE, ST_SetSRID(ST_Translate(geom, 0 ,yseries),21781) as geom 
FROM 
(
  SELECT generate_series(0, dy, 200) as yseries, st_translate(geom, xseries, 0) as geom 
  FROM 
  (
    SELECT  generate_series(0, dx, 200) as xseries, dy, geom 
    FROM 
    (
      SELECT st_envelope(st_makeline(st_makepoint(xmin,ymin), st_makepoint(xmin+200, ymin+200))) as geom, 
                  ((xmax-xmin)::integer / 200::integer)*200 as dx, ((ymax-ymin)::integer / 200::integer)*200 as dy 
      FROM 
      (
        SELECT ST_XMin(geometrie) as xmin, ST_YMin(geometrie) as ymin, ST_XMax(geometrie) as xmax, ST_YMax(geometrie) as ymax 
        FROM
        (
         SELECT gem_bfs, geometrie
         FROM av_avdpool_ng.tseinteilung_toleranzstufe
         WHERE art = 1
        ) as ts,
        (
         SELECT go_gem_bfs, gem_bfs, wkb_geometry
         FROM av_lokale_entzerrung.gemeinde_operate
         WHERE go_gem_bfs = 2450
        ) gem
        WHERE gem.gem_bfs = ts.gem_bfs
        AND gem.wkb_geometry && ts.geometrie
        AND ST_Intersects(gem.wkb_geometry, ts.geometrie)
      ) as s1
    ) as t1
  ) as t2
) as t3;
